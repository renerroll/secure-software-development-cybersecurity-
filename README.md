# Secure Architecture Lab ‚Äî Juice Shop analysis & —Ä—ñ—à–µ–Ω–Ω—è

## üçä –ö–æ—Ä–æ—Ç–∫–æ
–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –º—ñ—Å—Ç–∏—Ç—å –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–µ —Ä–µ–≤ º—é  –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ **OWASP Juice Shop** (–∑–∞–≤–¥–∞–Ω–Ω—è –≤–∏–∫–æ–Ω–∞–Ω–æ –∑–≥—ñ–¥–Ω–æ `task.md`): –∑–Ω–∞—Ö—ñ–¥–∫–∏, –ø–æ—Ä—É—à–µ–Ω—ñ –ø—Ä–∏–Ω—Ü–∏–ø–∏, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó —Ç–∞ –∫–æ—Ä–æ—Ç–∫—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å.

---

## üîç –ö–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–ø—É—Å–∫—É
- –û–±—Ä–∞–∑: `bkimminich/juice-shop:latest` (–º–∞—î digest)
- –°–ª—É—Ö–∞—î –ø–æ—Ä—Ç: `3000`
- OpenAPI (Swagger) –¥–æ—Å—Ç—É–ø–Ω–∏–π –Ω–∞ `/api-docs` (–∫–æ—Ä–∏—Å–Ω–æ –¥–ª—è DAST)
- Package metadata —Ç–∞ built server –∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –±—É–ª–∏ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ (`package.json`, `build/server.js`).

---

## üî¥ –©–æ–Ω–∞–π–º–µ–Ω—à–µ 5 –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∏—Ö –ø—Ä–æ–±–ª–µ–º (–∞–Ω–∞–ª—ñ–∑)

1) –•–∞—Ä–¥–∫–æ–¥ secret —É –∫–æ–¥—ñ
- –§–∞–π–ª: `build/server.js` (cookieParser('kekse'))
- –°—É—Ç—å: —Å–µ–∫—Ä–µ—Ç–∏ —É –∫–æ–¥—ñ ‚Üí –≤–∏—Ç—ñ–∫, –≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –æ–±–ª—ñ–∫—É –¥–æ—Å—Ç—É–ø—É
- –ü–æ—Ä—É—à–µ–Ω–∏–π –ø—Ä–∏–Ω—Ü–∏–ø: PoLP, —Å–µ–∫—Ä–µ—Ç-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Vault/SecretManager + CSI / `valueFrom.secretKeyRef`.

2) –ü—É–±–ª—ñ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ–π —ñ –ª–æ–≥—ñ–≤
- –§–∞–π–ª–∏/–µ–Ω–¥–ø–æ—ó–Ω—Ç–∏: `/ftp`, `/support/logs` (serve-index)
- –°—É—Ç—å: directory listing —Ç–∞ –ª–æ–≥–∏ –º–æ–∂—É—Ç—å –≤–∏—Ç—ñ–∫–∞—Ç–∏ —É –ø—É–±–ª—ñ—á–Ω–∏–π –¥–æ—Å—Ç—É–ø
- –ü–æ—Ä—É—à–µ–Ω–∏–π –ø—Ä–∏–Ω—Ü–∏–ø: –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω—ñ—Å—Ç—å, –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: –ø—Ä–∏–±—Ä–∞—Ç–∏ serve-index —É –ø—Ä–æ–¥—ñ; –∑–∞—Ö–∏—Å—Ç–∏—Ç–∏ –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ RBAC/–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—é.

3) –ù–∞–¥–º—ñ—Ä–Ω–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π CORS / –≤—ñ–¥–∫–ª—é—á–µ–Ω–∏–π XSS‚Äë—Ñ—ñ–ª—å—Ç—Ä
- –§–∞–π–ª: `build/server.js` (app.use(cors()), helmet.xssFilter –∑–∞–∫–æ–º–µ–Ω—Ç–æ–≤–∞–Ω–∏–π)
- –°—É—Ç—å: –ø—ñ–¥–≤–∏—â–µ–Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω—è –∞—Ç–∞–∫–∏ (XSS, CSRF —Ä–∏–∑–∏–∫–∏)
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: whitelist origin, —É–≤—ñ–º–∫–Ω—É—Ç–∏ CSP/helmet XSS‚Äë—Ñ—ñ–ª—å—Ç—Ä.

4) –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Å—Ç–∞—Ä–∏—Ö/–≤—Ä–∞–∑–ª–∏–≤–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
- –§–∞–π–ª: `package.json` (`jsonwebtoken@0.4.0`, `js-yaml@3.x` —Ç–æ—â–æ)
- –°—É—Ç—å: –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –∑ –≤—ñ–¥–æ–º–∏–º–∏ CVE ‚Üí supply-chain —Ä–∏–∑–∏–∫
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: SBOM + SCA (syft + trivy/grype), –æ–Ω–æ–≤–∏—Ç–∏/–ø—ñ–Ω–∏—Ç–∏ –ø–∞–∫—É–Ω–∫–∏.

5) Swagger –¥–æ—Å—Ç—É–ø–Ω–∏–π –ø—É–±–ª—ñ—á–Ω–æ (—Å–∏–≥–Ω–∞–ª –¥–ª—è DAST ‚Äî –¥–æ–±—Ä–µ, –∞–ª–µ –≤ –ø—Ä–æ–¥—ñ –º–∞—î –±—É—Ç–∏ –æ–±–º–µ–∂–µ–Ω–∏–º)
- Endpoint: `/api-docs`
- –°—É—Ç—å: –≤—ñ–¥–∫—Ä–∏—Ç–∏–π OpenAPI ‚Üí DAST –º–æ–∂–µ —Å–∫–∞–Ω—É–≤–∞—Ç–∏, –∞–ª–µ —É –ø—Ä–æ–¥—ñ –¥–æ—Å—Ç—É–ø —Å–ª—ñ–¥ –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏
- –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è: –æ–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ swagger (auth / internal-only).

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —Å–∏–≥–Ω–∞–ª—ñ–≤ (–ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω)
| –°–∏–≥–Ω–∞–ª / –ö–æ–Ω—Ç—Ä–æ–ª—å               | –Ñ / –ù–µ–º–∞—î | –ö–æ–º–µ–Ω—Ç–∞—Ä |
|---------------------------------|-----------|----------|
| OpenAPI / `response_model`      | ‚úÖ        | `/api-docs` –¥–æ—Å—Ç—É–ø–Ω–∏–π (–ø–æ–∑–∏—Ç–∏–≤ –¥–ª—è DAST) |
| SBOM / package script           | ‚úÖ        | `npm run sbom` –ø—Ä–∏—Å—É—Ç–Ω—ñ–π |
| CI/CD pipeline                  | ‚úÖ/‚ö†Ô∏è     | CI –≤ —Ä–µ–ø–æ (badges), –∞–ª–µ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ pipeline –∫–æ–Ω—Ñ—ñ–≥ | 
| Secrets via Vault / CSI         | ‚ùå        | —Å–µ–∫—Ä–µ—Ç–∏ ‚Äî —É –∫–æ–¥—ñ / env –≤—ñ–¥—Å—É—Ç–Ω—ñ |
| Image pinning (digest)          | ‚úÖ        | –æ–±—Ä–∞–∑ –º–∞—î repoDigest |
| SCA (Trivy / Grype)             | ‚ùå        | –ª–æ–∫–∞–ª—å–Ω–æ —Ç—Ä–µ–±–∞ –¥–æ–¥–∞—Ç–∏ —É CI |

---

## üîß –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–Ω—ñ –¥—ñ—ó (–ø–ª–∞–Ω –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å)
1. –ú—ñ–≥—Ä–∞—Ü—ñ—è —Å–µ–∫—Ä–µ—Ç—ñ–≤ —É Vault CSI / Kubernetes Secret (–∫—Ä–∏—Ç–∏—á–Ω–æ).  
2. –ó–∞–∫—Ä–∏—Ç–∏ –∞–±–æ –∑–∞—Ö–∏—Å—Ç–∏—Ç–∏ `/ftp`, `/support/logs` (–≤–∏—Å–æ–∫–∏–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç).  
3. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ SBOM + SCA —É CI (syft -> sbom, trivy/grype, –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ pin/update).  
4. –û–±–º–µ–∂–∏—Ç–∏ CORS, —É–≤—ñ–º–∫–Ω—É—Ç–∏ helmet.xssFilter/CSP (—Å–µ—Ä–µ–¥–Ω—ñ–π –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç).  
5. –û–±–º–µ–∂–∏—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ `/api-docs` —É –ø—Ä–æ–¥–∞–∫—à–Ω (–¥–æ–∑–≤–æ–ª–∏—Ç–∏ –ª–∏—à–µ –≤–Ω—É—Ç—Ä. –º–µ—Ä–µ–∂—ñ –∞–±–æ auth).

---

## –ü—Ä–∏–∫–ª–∞–¥–∏ –∑–º—ñ–Ω / —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∏
- –ó–∞–º—ñ–Ω–∞ —Ö–∞—Ä–¥–∫–æ–¥‚Äë—Å–µ–∫—Ä–µ—Ç—É:
```js
// before
app.use(cookieParser('kekse'))

// after
app.use(cookieParser(process.env.COOKIE_SECRET))
// COOKIE_SECRET –º–∞—î —ñ–Ω–∂–µ–∫—Ç–∏—Ç–∏—Å—å —á–µ—Ä–µ–∑ Vault CSI / SecretKeyRef
```

- –ì–∞–π–¥ –¥–ª—è CI (–æ–±–æ–≤'—è–∑–∫–æ–≤—ñ job-–∏): `sbom` ‚Üí `trivy` ‚Üí `semgrep` ‚Üí `gitleaks`.

## –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏

| –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è | –ü—Ä–∏–º—ñ—Ç–∫–∏ |
|---|---|---|
| Postman | –ù–∞–¥—Å–∏–ª–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤ –¥–æ API | –†—É—á–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è / —Å—Ü–µ–Ω–∞—Ä—ñ—ó |
| jwt.io | –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ / –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è JWT | –ù–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Å–µ–∫—Ä–µ—Ç–∏ –≤ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö —Å–µ—Ä–≤—ñ—Å–∞—Ö |
| –ë—Ä–∞—É–∑–µ—Ä | –ü–µ—Ä–µ–≥–ª—è–¥ –≤–µ–±‚Äë—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É | –§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞, DAST‚Äë–æ–≥–ª—è–¥ |
| Notepad / Word / Google Docs | –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–≤—ñ—Ç—É | –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ deliverables –¥–ª—è LMS / —Ä–µ–ø–æ |

---

## –í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å `task.md` (—â–æ –∑—Ä–æ–±–ª–µ–Ω–æ)
- –ü—Ä–æ–≤—ñ–≤ –∞—É–¥–∏—Ç –∑–∞–ø—É—â–µ–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (—Ñ–∞–π–ª–∏: `package.json`, `build/server.js`) ‚Äî ‚úÖ
- –í–∏–∫–æ–Ω–∞–≤ –∑–≤—ñ—Ç (—Ü–µ–π README ‚Äî —Å–µ–∫—Ü—ñ—è –∑ –∞–Ω–∞–ª—ñ–∑–æ–º —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è–º–∏) ‚Äî ‚úÖ
- –ù–∞–¥–∞–Ω–æ –ø—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏ —Ç–∞ –ø—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–ø—Ä–∞–≤–ª–µ–Ω—å ‚Äî ‚úÖ

---

